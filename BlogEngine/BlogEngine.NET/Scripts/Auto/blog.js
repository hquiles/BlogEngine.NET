BlogEngine = { $: function (a) { return document.getElementById(a) }, setFlag: function (a) { a.length > 0 ? BlogEngine.comments.flagImage.src = BlogEngineRes.webRoot + "Content/images/blog/flags/" + a + ".png" : BlogEngine.comments.flagImage.src = BlogEngineRes.webRoot + "Content/images/blog/pixel.gif" }, showCommentPreview: function () { var a = this.$("preview"), b = this.$("compose"); a && (a.className = "selected"), b && (b.className = ""), this.$("commentCompose").style.display = "none", this.$("commentPreview").style.display = "block", this.$("commentPreview").innerHTML = '<img src="' + BlogEngineRes.webRoot + 'Content/images/blog/ajax-loader.gif" width="24" height="24" alt="Loading" />'; this.$("commentPreview").innerHTML; return this.addComment(!0), !1 }, composeComment: function () { var a = this.$("preview"), b = this.$("compose"); return a && (a.className = ""), b && (b.className = "selected"), this.$("commentPreview") && (this.$("commentPreview").style.display = "none"), this.$("commentCompose") && (this.$("commentCompose").style.display = "block"), !1 }, endShowPreview: function (a, b) { BlogEngine.$("commentPreview") && (BlogEngine.$("commentPreview").innerHTML = a) }, toggleCommentSavingIndicators: function (a) { BlogEngine.$("btnSaveAjax").disabled = a, BlogEngine.$("ajaxLoader").style.display = a ? "inline" : "none", BlogEngine.$("status").className = "", BlogEngine.$("status").innerHTML = "", a || (BlogEngine.$("commentPreview") && (BlogEngine.$("commentPreview").innerHTML = ""), BlogEngine.composeComment()) }, onCommentError: function (a, b) { BlogEngine.toggleCommentSavingIndicators(!1), a = a || "Unknown error occurred."; var c = a.indexOf("|"); if (c > 0) for (a = a.substr(0, c) ; a.length > 0 && a.substr(a.length - 1, 1).match(/\d/) ;) a = a.substr(0, a.length - 1); document.getElementById("recaptcha_response_field") && Recaptcha.reload(), document.getElementById("spnSimpleCaptchaIncorrect") && (document.getElementById("spnSimpleCaptchaIncorrect").style.display = "none"), alert("Sorry, the following error occurred while processing your comment:\n\n" + a) }, addComment: function (a) { var b = 1 == a; b || (BlogEngine.toggleCommentSavingIndicators(!0), this.$("status").innerHTML = BlogEngineRes.i18n.savingTheComment); var c = BlogEngine.comments.nameBox.value, d = BlogEngine.comments.emailBox.value, e = BlogEngine.comments.contentBox.value, f = BlogEngine.comments.captchaField.value, g = BlogEngine.comments.websiteBox ? BlogEngine.comments.websiteBox.value : "", h = BlogEngine.comments.countryDropDown ? BlogEngine.comments.countryDropDown.value : "", i = !!BlogEngine.$("cbNotify") && BlogEngine.$("cbNotify").checked, j = BlogEngine.comments.replyToId ? BlogEngine.comments.replyToId.value : "", k = document.getElementById("recaptcha_response_field"), l = k ? k.value : "", m = document.getElementById("recaptcha_challenge_field"), n = m ? m.value : "", o = document.getElementById("simpleCaptchaValue"), p = o ? o.value : "", q = BlogEngine.$("avatarImgSrc"), r = q && q.value ? q.value : "", s = b ? BlogEngine.endShowPreview : BlogEngine.appendComment, t = c + "-|-" + d + "-|-" + g + "-|-" + h + "-|-" + e + "-|-" + i + "-|-" + b + "-|-" + f + "-|-" + j + "-|-" + r + "-|-" + l + "-|-" + n + "-|-" + p; WebForm_DoCallback(BlogEngine.comments.controlId, t, s, "comment", BlogEngine.onCommentError, !1), b || "undefined" == typeof OnComment || OnComment(c, d, g, h, e) }, cancelReply: function () { this.replyToComment("") }, replyToComment: function (a) { BlogEngine.comments.replyToId.value = a; var b = BlogEngine.$("comment-form"); if (a && "" != a && null != a && "00000000-0000-0000-0000-000000000000" != a) { BlogEngine.$("cancelReply").style.display = ""; var d = BlogEngine.$("id_" + a), e = BlogEngine.$("replies_" + a); null == e && (e = document.createElement("div"), e.className = "comment-replies", e.id = "replies_" + a, d.appendChild(e)), e.style.display = "", e.appendChild(b) } else { var c = BlogEngine.$("commentlist"); c.appendChild(b), BlogEngine.$("cancelReply").style.display = "none" } BlogEngine.comments.nameBox.focus() }, appendComment: function (a, b) { if ("comment" == b) if (document.getElementById("recaptcha_response_field") && Recaptcha.reload(), document.getElementById("spnSimpleCaptchaIncorrect") && (document.getElementById("spnSimpleCaptchaIncorrect").style.display = "none"), "RecaptchaIncorrect" == a || "SimpleCaptchaIncorrect" == a) document.getElementById("spnCaptchaIncorrect") && (document.getElementById("spnCaptchaIncorrect").style.display = ""), document.getElementById("spnSimpleCaptchaIncorrect") && (document.getElementById("spnSimpleCaptchaIncorrect").style.display = ""), BlogEngine.toggleCommentSavingIndicators(!1); else { document.getElementById("spnCaptchaIncorrect") && (document.getElementById("spnCaptchaIncorrect").style.display = "none"), document.getElementById("spnSimpleCaptchaIncorrect") && (document.getElementById("spnSimpleCaptchaIncorrect").style.display = "none"); var c = BlogEngine.$("commentlist"); c.innerHTML.length < 10 && (c.innerHTML = "<h1 id='comment'>" + BlogEngineRes.i18n.comments + "</h1>"); var d = BlogEngine.comments.replyToId ? BlogEngine.comments.replyToId.value : ""; if ("" != d) { var e = BlogEngine.$("replies_" + d); e.innerHTML += a } else c.innerHTML += a, c.style.display = "block"; BlogEngine.comments.contentBox.value = "", BlogEngine.comments.contentBox = BlogEngine.$(BlogEngine.comments.contentBox.id), BlogEngine.toggleCommentSavingIndicators(!1), BlogEngine.$("status").className = "success", BlogEngine.comments.moderation ? BlogEngine.$("status").innerHTML = BlogEngineRes.i18n.commentWaitingModeration : BlogEngine.$("status").innerHTML = BlogEngineRes.i18n.commentWasSaved; var f = BlogEngine.$("comment-form"); c.appendChild(f), BlogEngine.comments.replyToId && (BlogEngine.comments.replyToId.value = ""), BlogEngine.$("cancelReply") && (BlogEngine.$("cancelReply").style.display = "none") } BlogEngine.$("btnSaveAjax").disabled = !1 }, validateAndSubmitCommentForm: function () { return BlogEngine.comments.nameBox.value.length < 1 ? (BlogEngine.$("status").innerHTML = "Name is required.", BlogEngine.$("status").className = "warning", BlogEngine.$("txtName").focus(), !1) : BlogEngine.comments.emailBox.value.length < 1 ? (BlogEngine.$("status").innerHTML = "Email is required.", BlogEngine.$("status").className = "warning", BlogEngine.$("txtEmail").focus(), !1) : BlogEngine.comments.contentBox.value.length < 1 ? (BlogEngine.$("status").innerHTML = "Comment is required.", BlogEngine.$("status").className = "warning", BlogEngine.$("txtContent").focus(), !1) : (BlogEngine.addComment(), !0) }, addBbCode: function (a) { try { var b = BlogEngine.comments.contentBox; if (b.selectionStart) { var c = b.value.substring(0, b.selectionStart), d = b.value.substr(b.selectionEnd), e = b.value.substring(b.selectionStart, b.selectionEnd); b.value = c + "[" + a + "]" + e + "[/" + a + "]" + d, b.focus() } else if (document.selection && document.selection.createRange) { var f = document.selection.createRange().text; b.focus(); var e = document.selection.createRange(); e.text = "[" + a + "]" + f + "[/" + a + "]" } } catch (a) { } }, search: function (a, b) { b || (b = "searchfield"); var c = this.$(b), d = this.$("searchcomments"), e = "undefined" == typeof BlogEngineRes.fileExtension ? ".aspx" : BlogEngineRes.fileExtension, f = "search" + e + "?q=" + encodeURIComponent(c.value); return null != d && d.checked && (f += "&comment=true"), top.location.href = a + f, !1 }, searchClear: function (a, b) { b || (b = "searchfield"); var c = this.$(b); c.value == a ? c.value = "" : "" == c.value && (c.value = a) }, rate: function (a, b, c) { this.createCallback("rating.axd?id=" + b + "&rating=" + c, BlogEngine.ratingCallback, a) }, ratingCallback: function (a) { var b = a.substring(0, 1), c = a.substring(1); "OK" == c ? ("undefined" != typeof OnRating && OnRating(b), alert(BlogEngineRes.i18n.ratingHasBeenRegistered)) : "HASRATED" == c ? alert(BlogEngineRes.i18n.hasRated) : alert("An error occured while registering your rating. Please try again") }, createCallback: function (a, b, c) { var d = BlogEngine.getHttpObject(); d.open("GET", a, !0), c && d.setRequestHeader && d.setRequestHeader("x-blog-instance", c.toString()), d.onreadystatechange = function () { 4 == d.readyState && d.responseText.length > 0 && null != b && b(d.responseText) }, d.send(null) }, getHttpObject: function () { if ("undefined" != typeof XMLHttpRequest) return new XMLHttpRequest; try { return new ActiveXObject("Msxml2.XMLHTTP") } catch (a) { try { return new ActiveXObject("Microsoft.XMLHTTP") } catch (a) { } } return !1 }, updateCalendar: function (a, b) { var c = BlogEngine.$("calendarContainer"); c.innerHTML = a, BlogEngine.Calendar.months[b] = a }, toggleMonth: function (a) { var b = BlogEngine.$("monthList"), c = b.getElementsByTagName("ul"); for (i = 0; i < c.length; i++) if (c[i].id == a) { var d = "open" == c[i].className ? "" : "open"; c[i].className = d; break } }, equal: function (a, b) { var c = a.toLowerCase().replace(new RegExp(" ", "gi"), ""), d = b.toLowerCase().replace(new RegExp(" ", "gi"), ""); return c == d }, xfnRelationships: ["friend", "acquaintance", "contact", "met", "co-worker", "colleague", "co-resident", "neighbor", "child", "parent", "sibling", "spouse", "kin", "muse", "crush", "date", "sweetheart", "me"], hightLightXfn: function () { var a = BlogEngine.$("content"); if (null != a) { var b = a.getElementsByTagName("a"); for (i = 0; i < b.length; i++) { var c = b[i], d = c.getAttribute("rel"); if (d && "nofollow" != d) for (j = 0; j < BlogEngine.xfnRelationships.length; j++) if (d.indexOf(BlogEngine.xfnRelationships[j]) > -1) { c.title = "XFN relationship: " + d; break } } } }, showRating: function (a, b, c, d, e) { var f = document.createElement("div"); f.className = "rating"; var g = document.createElement("p"); f.appendChild(g), 0 == c ? g.innerHTML = BlogEngineRes.i18n.beTheFirstToRate : g.innerHTML = BlogEngineRes.i18n.currentlyRated.replace("{0}", new Number(d).toFixed(1)).replace("{1}", c); var h = document.createElement("ul"); h.className = "star-rating small-star", f.appendChild(h); var i = document.createElement("li"); i.className = "current-rating", i.style.width = Math.round(20 * d) + "%", i.innerHTML = "Currently " + d + "/5 Stars.", h.appendChild(i); for (var j = 1; j <= 5; j++) { var k = document.createElement("li"), l = document.createElement("a"); l.innerHTML = j, l.href = "rate/" + j, l.className = this.englishNumber(j), l.title = BlogEngineRes.i18n.rateThisXStars.replace("{0}", j.toString()).replace("{1}", 1 == j ? "" : "s"), l.rel = "nofollow", l.onclick = function () { return BlogEngine.rate(e, b, this.innerHTML), !1 }, k.appendChild(l), h.appendChild(k) } a.innerHTML = "", a.appendChild(f), a.style.visibility = "visible" }, applyRatings: function () { for (var a = document.getElementsByTagName("div"), b = 0; b < a.length; b++) if ("ratingcontainer" == a[b].className) { var c = a[b].innerHTML.split("|"); BlogEngine.showRating(a[b], c[0], c[1], c[2], c[3]) } }, englishNumber: function (a) { return 1 == a ? "one-star" : 2 == a ? "two-stars" : 3 == a ? "three-stars" : 4 == a ? "four-stars" : "five-stars" }, addLoadEvent: function (a) { var b = window.onload; "function" != typeof window.onload ? window.onload = a : window.onload = function () { b(), a() } }, filterByAPML: function () { var a = document.documentElement.clientWidth + document.documentElement.scrollLeft; document.documentElement.clientHeight + document.documentElement.scrollTop; document.body.style.position = "static"; var c = document.createElement("div"); c.style.zIndex = 2, c.id = "layer", c.style.position = "absolute", c.style.top = "0px", c.style.left = "0px", c.style.height = document.documentElement.scrollHeight + "px", c.style.width = a + "px", c.style.backgroundColor = "black", c.style.opacity = ".6", c.style.filter += "progid:DXImageTransform.Microsoft.Alpha(opacity=60)", document.body.appendChild(c); var d = document.createElement("div"); d.style.zIndex = 3, d.id = "apmlfilter", d.style.position = navigator.userAgent.indexOf("MSIE 6") > -1 ? "absolute" : "fixed", d.style.top = "200px", d.style.left = a / 2 - 200 + "px", d.style.height = "50px", d.style.width = "400px", d.style.backgroundColor = "white", d.style.border = "2px solid silver", d.style.padding = "20px", document.body.appendChild(d); var e = document.createElement("p"); e.innerHTML = BlogEngineRes.i18n.apmlDescription, e.style.margin = "0px", d.appendChild(e); var f = document.createElement("form"); f.method = "get", f.style.display = "inline", f.action = BlogEngineRes.webRoot, d.appendChild(f); var g = document.createElement("input"); g.type = "text", g.value = BlogEngine.getCookieValue("url") || "http://", g.style.width = "320px", g.id = "txtapml", g.name = "apml", g.style.background = "url(" + BlogEngineRes.webRoot + "Content/images/blog/apml.png) no-repeat 2px center", g.style.paddingLeft = "16px", f.appendChild(g), g.focus(); var h = document.createElement("input"); h.type = "submit", h.value = BlogEngineRes.i18n.filter, h.onclick = function () { location.href = BlogEngineRes.webRoot + "?apml=" + encodeURIComponent(BlogEngine.$("txtapml").value) }, f.appendChild(h); var i = document.createElement("br"); d.appendChild(i); var j = document.createElement("a"); j.innerHTML = BlogEngineRes.i18n.cancel, j.href = "javascript:void(0)", j.onclick = function () { document.body.removeChild(BlogEngine.$("layer")), document.body.removeChild(BlogEngine.$("apmlfilter")), document.body.style.position = "" }, d.appendChild(j) }, getCookieValue: function (a) { var b = new String(document.cookie); if (null != b && b.indexOf("comment=") > -1) { var c = b.indexOf(a + "=") + a.length + 1, d = b.indexOf("&", c); if (d > c && c > -1) return b.substring(c, d) } return null }, test: function () { alert("test") }, comments: { flagImage: null, contentBox: null, moderation: null, checkName: null, postAuthor: null, nameBox: null, emailBox: null, websiteBox: null, countryDropDown: null, captchaField: null, controlId: null, replyToId: null } }, BlogEngine.addLoadEvent(BlogEngine.hightLightXfn), "undefined" == typeof $ && (window.$ = BlogEngine.$), BlogEngine.addLoadEvent(BlogEngine.applyRatings);